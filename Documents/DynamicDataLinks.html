<html>
<head><title>SWIFT data request 
</title>
<link rel="icon" type="image/png" href="SWIFTlogo_icon.png">
<style>
    .form-row {
        margin: 8px 0;
    }
    .datetime-input-group {
        display: flex;
        gap: 12px;
        align-items: center;
        margin: 8px 0;
        flex-wrap: wrap;
    }
</style>
</head>

<body BGCOLOR=white>

<img width=60 src="SWIFTlogo_icon.png">
<font size="6">
SWIFT data 
</font>
<br>
<br>

The main page for the Surface Wave Instrument Float with Tracking is <a href="http://www.apl.washington.edu/swift">apl.uw.edu/swift</a><br>
<br>
<hr>
<font size="6">
Telemetry data
</font>
<br>
Telemetry formats and automation are documented at <a href="https://github.com/SASlabgroup/SWIFT-codes/blob/master/Documents/SWIFT_telemetry_access.pdf">SWIFT_telemetry_access.pdf</a>
<br>
A live map with any buoys reporting within the last 3 hours is at <a href="http://swiftserver.apl.washington.edu/map/">swiftserver.apl.uw.edu/map</a>, and this <a href="http://swiftserver.apl.washington.edu/services/buoy?action=get_data&buoy_name=all&start=recent&format=kml">kml file</a> has the same information for viewing in  any GIS software.
<br>
A dashboard with simple telemetry data display is at <a href="https://swiftdashboard.apl.uw.edu">https://swiftdashboard.apl.uw.edu</a>.
<br>
Select SWIFTs and microSWIFTs can also be viewed in the <a href="https://software.apl.uw.edu/proto/BackyardBuoys/app.php">Backyard Buoys app</a>.
<br>
Telemetry data can also be accessed directly in Matlab using <a href="https://github.com/SASlabgroup/SWIFT-codes/blob/master/GeneralTools/pullSWIFTtelemetry.m">pullSWIFTtelemetry.m</a> 
or in Python <a href="https://github.com/SASlabgroup/microSWIFTtelemetry"> with this package</a> (presently microSWIFTs only). 
<br><br>
<!-- ################################################################################################################################# -->
<hr>
Manual telemetry queries for <b>simple position and time data</b> are URLs generated from this form 
<form name="input" action="http://swiftserver.apl.washington.edu/kml?action=kml" method="get" onsubmit="return formatDates(event, 'kml')">
<input type="hidden" name="action" value="kml"> <br>
<div class="form-row">
ID: <input type="text" name="buoy_name" id="buoy_name_kml" size="18"> (examples: SWIFT 09, microSWIFT 007)
</div>
<div class="datetime-input-group">
    start datetime: <input type="text" id="start_datetime_kml" size="25" placeholder="YYYY-MM-DDTHH:MM:SS"> (UTC, 24-hour format)
    or use: <input type="date" id="start_date_kml"> 
    <input type="time" id="start_time_kml" value="00:00:00" step="1"> 
    <input type="hidden" name="start" id="start_kml_formatted">
</div>
<div class="datetime-input-group">
    end datetime: <input type="text" id="end_datetime_kml" size="25" placeholder="YYYY-MM-DDTHH:MM:SS"> (UTC, 24-hour format)
    or use: <input type="date" id="end_date_kml"> 
    <input type="time" id="end_time_kml" value="00:00:00" step="1"> 
    <input type="hidden" name="end" id="end_kml_formatted">
</div>
<div class='live-link-group'>
    <input type="checkbox", id="live_link_kml", checked> <label for="live-link">Live Link, pull all data until present time (UTC)</label>
</div>
<div class="form-row">
data type: <select name="format">
<option value="kml" selected>kml</option>
<option value="json">json</option>
</select> (kml is Google Earth, json is simple text)
</div>
<input type="submit" value="Submit">
</form>
<!-- <! Alternative (direct link example):
<!<input type="text" size="175" name="prog_site" id="prog_site" value="http://swiftserver.apl.washington.edu/kml?action=kml&buoy_name=SWIFT%2015&start=2014-05-09T00:00:00&end=2014-05-09T17:00:00&format=kml" />
<!<a href="#" onclick="this.href=document.getElementById('prog_site').value" target="_blank">
<!Submit</a> -->
<hr>
<!-- ################################################################################################################################# -->
Manual telemetry queries for <b>full binary 'sbd' data from all sensor payloads</b> are URLs generated from this form 
<br> 
<form name="input" action="http://swiftserver.apl.washington.edu/services/buoy?" method="get" onsubmit="return formatDates(event, 'sbd')">
<input type="hidden" name="action" value="get_data"> <br>
<div class="form-row">
ID: <input type="text" name="buoy_name" size="10"> (examples: SWIFT 09, microSWIFT 007)
</div>
<div class="datetime-input-group">
    start datetime: <input type="text" id="start_datetime_sbd" size="25" placeholder="YYYY-MM-DDTHH:MM:SS">
    or use: <input type="date" id="start_date_sbd">
    <input type="time" id="start_time_sbd" value="00:00:00" step="1"> (UTC, 24-hour format)
    <input type="hidden" name="start" id="start_sbd_formatted">
</div>
<div class="datetime-input-group">
    end datetime: <input type="text" id="end_datetime_sbd" size="25" placeholder="YYYY-MM-DDTHH:MM:SS">
    or use: <input type="date" id="end_date_sbd">
    <input type="time" id="end_time_sbd" value="00:00:00" step="1"> (UTC, 24-hour format)
    <input type="hidden" name="end" id="end_sbd_formatted">
</div>
<div class='live-link-group'>
    <input type="checkbox", id="live_link_sbd", checked> <label for="live-link">Live Link, pull all data until present time (UTC)</label>
</div>
<input type="hidden" name="format" value="zip">
<input type="submit" value="Submit">
</form>
<br>
<!-- ################################################################################################################################# -->
<hr>
<br>
<b>Debug links</b> 
<br>
<br>
List of all buoy names and IMEI modem numbers  <a href="https://swiftserver.apl.uw.edu/services/active_buoys"> active in the last 30 days</a>.  <br>
<br>
Query for specific IMEI modem number (instead of buoy name) in the last 30 days 
<form name="input" action="https://swiftserver.apl.uw.edu/services/recent_data?" method="get">
<input type="hidden" name="action" value="get_data"> 
IMEI: <input type="text" name="buoy_id" size="20"> (example: 300434067057070)<br>
<input type="submit" value="Submit">
</form>
<br>

<hr>

<br>
<font size="6">
Archival data
</font>
<br>
<br>
Description of variables is in the <a href="./readme.txt">readme</a> file.
<br>
<br>
A master archive of microSWIFT data is at <a href="https://doi.org/10.5061/dryad.jdfn2z3j1"> https://doi.org/10.5061/dryad.jdfn2z3j1 </a>
<br>
<br>
A master archive of SWIFT data is intended... <i>someday</i>. 
<br>
<br>
Project-specific archives: 
<br>
Coastal Fronts (2022): <a href="https://hdl.handle.net/1773/52881"> https://hdl.handle.net/1773/52881 </a>
<br>
Salinity and Stratification at the Sea Ice Edge (2022): <a href="https://doi.org/10.5067/SASSIE-SWFT2"> https://doi.org/10.5067/SASSIE-SWFT2 </a>
<br>
Northern Seas Rapid Surface Evolution (2021): <a href="http://hdl.handle.net/1773/51039"> http://hdl.handle.net/1773/51039</a>
<br>
Seafloor cable calibration in the Arctic (2021): <a href="https://doi.org/10.18739/A2B853K37"> https://doi.org/10.18739/A2B853K37 </a>
<br>
During Nearshore Events Experiment (2021): <a href="https://doi.org/10.5061/dryad.hx3ffbgk0"> https://doi.org/10.5061/dryad.hx3ffbgk0 </a>
<br>
Atlantic Tradewind Ocean-Atmosphere Mesoscale Interaction Campaign (2020): <a href="https://doi.org/10.25921/s5d7-tc07"> https://doi.org/10.25921/s5d7-tc07 </a>
<br>
Bubble plumes at Station Papa (2019): <a href="https://doi.org/10.5061/dryad.d7wm37q6z"> https://doi.org/10.5061/dryad.d7wm37q6z </a>
<br>
Sea-surface reconstruction and wave-resolved projections (2019): <a href="http://hdl.handle.net/1773/46928"> http://hdl.handle.net/1773/46928 </a>
<br>
Antarctic Marginal Ice Zone (2019): <a href="https://doi.org/10.5281/zenodo.7845764">https://doi.org/10.5281/zenodo.7845764 </a>
<br>
Wave-driven ice edge observations (2018): <a href="http://hdl.handle.net/1773/46602"> http://hdl.handle.net/1773/46602 </a>
<br>
Langmuir Circulation experiment (2017): <a href="https://doi.org/10.5061/dryad.cvdncjt7s"> https://doi.org/10.5061/dryad.cvdncjt7s </a>
<br>
Inner Shelf experiment (2017): <a href="https://doi.org/10.6075/J0GF0TNQ"> https://doi.org/10.6075/J0GF0TNQ </a>
<br>
Arctic SeaState experiment (2015): <a href="https://doi.org/10.7265/qt2b-y743"> https://doi.org/10.7265/qt2b-y743 </a>
<br>
Marginal Ice Zone experiment (2014): <a href="https://doi.org/10.7265/j769-hn64"> https://doi.org/10.7265/j769-hn64  </a> 

<br>
<br>

Legacy (older) projects with SWIFT data are informally archived in directories <a href="http://faculty.washington.edu/jmt3rd/SWIFTdata/">here</a><br>

<script>
// When the page loads, set default start/end dates and times, then initialize syncing
window.addEventListener('DOMContentLoaded', () => {
    const now = new Date();
    const yesterday = new Date(now);
    yesterday.setUTCDate(yesterday.getUTCDate() - 1);

    const formatDate = d => d.toISOString().slice(0, 10); // YYYY-MM-DD
    const formatTime = d => d.toISOString().slice(11, 19); // HH:MM:SS

    const yesterdayDate = formatDate(yesterday);
    const todayDate = formatDate(now);
    const nowTime = formatTime(now);

    // Set KML form defaults
    setDefaults('kml', yesterdayDate, todayDate, nowTime, nowTime);

    // Set SBD form defaults
    setDefaults('sbd', yesterdayDate, todayDate, nowTime, nowTime);

    // Activate synchronization for both forms
    ['kml', 'sbd'].forEach(syncDateTimeInputs);
});

// Helper to set default values for a form
function setDefaults(formType, startDate, endDate, startTime, endTime) {
    document.getElementById(`start_date_${formType}`).value = startDate;
    document.getElementById(`start_time_${formType}`).value = startTime;
    document.getElementById(`end_date_${formType}`).value = endDate;
    document.getElementById(`end_time_${formType}`).value = endTime;
    document.getElementById(`start_datetime_${formType}`).value = `${startDate}T${startTime}`;
}

// Main function to keep start/end fields, date/time pickers, and Live Link in sync
function syncDateTimeInputs(formType) {
    const startDT = document.getElementById(`start_datetime_${formType}`);
    const startDate = document.getElementById(`start_date_${formType}`);
    const startTime = document.getElementById(`start_time_${formType}`);
    const endDT = document.getElementById(`end_datetime_${formType}`);
    const endDate = document.getElementById(`end_date_${formType}`);
    const endTime = document.getElementById(`end_time_${formType}`);
    const live = document.getElementById(`live_link_${formType}`);

    // --------- START FIELD SYNC ---------
    // Text field → pickers
    startDT.addEventListener('input', () => {
        const [d, t] = startDT.value.split('T') ?? [];
        if (d) startDate.value = d;
        if (t) startTime.value = t;
    });

    // Pickers → text field
    [startDate, startTime].forEach(el =>
        el.addEventListener('input', () => {
            if (startDate.value && !startTime.value) startTime.value = "00:00:00";
            startDT.value = startDate.value && startTime.value ? `${startDate.value}T${startTime.value}` : '';
        })
    );

    // --------- END FIELD SYNC ---------
    function updateEndFromPickers() {
        // Fill missing time if date exists
        if (endDate.value && !endTime.value) endTime.value = "00:00:00";

        // Both date and time selected → update datetime field and uncheck Live Link
        if (endDate.value && endTime.value) {
            endDT.value = `${endDate.value}T${endTime.value}`;
            live.checked = false;
        }
        // Both cleared → re-enable Live Link
        else if (!endDate.value && !endTime.value) {
            endDT.value = '';
            live.checked = true;
        }
        updateLiveState();
    }

    // Update whenever pickers change
    ['input', 'change'].forEach(evt => {
        endDate.addEventListener(evt, updateEndFromPickers);
        endTime.addEventListener(evt, updateEndFromPickers);
    });

    // --------- END DATETIME TEXT FIELD SYNC ---------
    // Text → pickers, uncheck Live Link if proper value
    endDT.addEventListener('input', () => {
        const val = endDT.value.trim();
        if (val.includes('T')) {
            const [d, t] = val.split('T');
            endDate.value = d;
            endTime.value = t;
            live.checked = false;
        } else {
            // allow typing, do not auto-check live yet
            endDate.value = '';
            endTime.value = '';
        }
        updateLiveState();
    });

    // Re-check Live Link only when field loses focus and is empty
    endDT.addEventListener('blur', () => {
        if (!endDT.value.trim()) {
            live.checked = true;
            updateLiveState();
        }
    });

    // Focusing any end picker → uncheck Live Link and rebuild end datetime
    [endDate, endTime].forEach(el =>
        el.addEventListener('focus', () => {
            if (live.checked && (endDate.value || endTime.value)) live.checked = false;
            updateEndFromPickers();
        })
    );

    // Focusing datetime text field → uncheck Live Link
    endDT.addEventListener('focus', () => {
        if (live.checked) live.checked = false;
    });

    // --------- LIVE LINK VISUAL UPDATE ---------
    live.addEventListener('change', updateLiveState);

    function updateLiveState() {
        const isLive = live.checked;
        [endDT, endDate, endTime].forEach(el => {
            el.classList.toggle('grayed', isLive); // gray out if Live Link
            if (isLive) el.value = ''; // clear visually
        });
    }

    updateLiveState();
}

// Called on form submit to fill hidden start/end fields for the URL
function formatDates(event, formType) {
    const startDT = document.getElementById(`start_datetime_${formType}`).value;
    const startDate = document.getElementById(`start_date_${formType}`).value;
    const startTime = document.getElementById(`start_time_${formType}`).value;
    const endDT = document.getElementById(`end_datetime_${formType}`).value;
    const endDate = document.getElementById(`end_date_${formType}`).value;
    const endTime = document.getElementById(`end_time_${formType}`).value;
    const live = document.getElementById(`live_link_${formType}`).checked;

    // Fill start hidden field (this is the variable where we store what we send the server)
    const startField = document.getElementById(`start_${formType}_formatted`);
    startField.value = startDT || (startDate && startTime ? `${startDate}T${startTime}` : '');

    // Fill end hidden field (this is the variable where we store what we send the server)
    const endField = document.getElementById(`end_${formType}_formatted`);
    if (live) endField.value = '';
    else if (endDT) endField.value = endDT;
    else if (endDate && endTime) endField.value = `${endDate}T${endTime}`;
    else endField.value = '';

    return true;
}
</script>


<style>
/* Grayed but still active */
.grayed {
    background-color: #f0f0f0 !important;
    color: #888 !important;
}
</style>
</body>
</html>